?="TinyBasicマンデルブロ開始"
/

: 固定小数点スケールファクタ（F=50）
F=50

: Y=-12から12まで（25行）
Y=-12
^LOOP_Y
    : X=-39から39まで（79文字）  
    X=-39
    ^LOOP_X
        : 座標変換: X*229/100（0.0458*F相当）
        C=X*229/100
        
        : 座標変換: Y*416/100（0.0833*F相当） 
        D=Y*416/100
        
        : 初期値設定
        A=C
        B=D
        I=0
        
        : マンデルブロ反復計算
        ^MANDEL_LOOP
            : B/F の整数部と小数部を計算
            Q=B/F
            S=B-Q*F
            
            : 新しいA値: (A*A - B*B)/F + C
            T=(A*A-B*B)/F+C
            
            : 新しいB値: 2*(A*Q + A*S/F) + D
            B=2*(A*Q+A*S/F)+D
            
            : A値を更新
            A=T
            
            : 発散判定: (A/F)^2 + (B/F)^2 > 4*F
            P=A/F
            Q=B/F
            ;=P*P+Q*Q>4*F #=^DIVERGED
            
            : 反復カウンタ増加
            I=I+1
            ;=I<=15 #=^MANDEL_LOOP
            
            : 最大反復回数に達した場合（内部の点）
            $=' '
            #=^NEXT_X
        
        : 発散した場合
        ^DIVERGED
            : 反復回数に基づく文字出力
            ;=I>9 I=I+7
            : ASCII文字として出力（0-9, A-F）
            $=48+I
        
        ^NEXT_X
        X=X+1
        ;=X<=39 #=^LOOP_X
    
    : 改行
    /
    Y=Y+1
    ;=Y<=12 #=^LOOP_Y

?="完了"
#=-1